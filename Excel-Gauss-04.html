<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ['\\(','\\)'] ],
    processEscapes: true
  },
  TeX: {
    extensions: ["mhchem.js"]
  },
  CommonHTML: {
    matchFontHeight: false
  }
});
</script>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML">
</script>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Excel</title>
<link href="090413.css" rel="stylesheet" type="text/css" />
<link href="160324.css" rel="stylesheet" type="text/css" />

<style type="text/css">

.style7 {color: #000000; }

.style10 {color: #000000; }

.style1 {color: #0000FF}

</style>
</head>

<body>
<p><span class="X-Large-Bold-RED">エクセル関数</span></p>
<p class="Large-Bold-Red">・誤差関数の逆関数</p>
<p class="Large-Bold-Red">・\(\Large \displaystyle     ERFINV(x) = \frac{1}{\sqrt{2}} NORMSINV \left\{ \frac{1+x}{2} \right\}    \)</p>
<p>まず，</p>
<p class="Blue-Bold">・NORMSDIST(x)　：　標準正規分布（μ=0, σ=1）の累積分布関数</p>
<p>\(\Large \displaystyle   \frac{1}{\sqrt{2 \pi}} \int_{- \infty}^x exp \left( - \frac{t^2}{2} \right) dt \)</p>
<p>&nbsp;</p>
<p class="Blue-Bold">・ERF(x)　：　誤差関数</p>
<p>\(\Large \displaystyle    \frac{2}{\sqrt{\pi}} \int_{0}^x exp \left( - t^2 \right) dt \)</p>
<p>&nbsp;</p>
<p>両者を見るとよく似た関数形式であることがわかります．</p>
<p>まずは，NORMSDIST(x)，を変形させていきましょう．</p>
<p>\(\Large \displaystyle   NORMSDIST(x) = \frac{1}{\sqrt{2 \pi}} \int_{- \infty}^x exp \left( - \frac{t^2}{2} \right) dt \)</p>
<p>\(\Large \displaystyle    = \frac{1}{\sqrt{2 \pi}} \left[ \int_{- \infty}^0 exp \left( - \frac{t^2}{2} \right) dt + \int_{0}^x exp \left( - \frac{t^2}{2} \right) dt\right] \)</p>
<p>第一項は規格化された正規分布の左半分となりますので，</p>
<p>\(\Large \displaystyle    = 0.5 + \frac{1}{\sqrt{2 \pi}} \int_{0}^x exp \left( - \frac{t^2}{2} \right) dt \)</p>
<p>第二項を変数変換すると，</p>
<p>\(\Large \displaystyle     \frac{1}{\sqrt{2 \pi}} \int_{0}^x exp \left( - \frac{t^2}{2} \right) dt \)</p>
<p>\(\Large \displaystyle     y^2 \equiv \frac{t^2}{2} \ \rightarrow \ y = \frac{t}{2} \ \rightarrow \sqrt{2} dy = dt \)</p>
<p>\(\Large \displaystyle \hspace{15pt} 0 \longleftrightarrow t \longleftrightarrow \hspace{15pt} x\)</p>
<p>\(\Large \displaystyle \hspace{15pt} 0 \longleftrightarrow y \longleftrightarrow \frac{x}{\sqrt{2}} \)</p>
<p>したがって，</p>
<p>\(\Large \displaystyle     = \frac{\sqrt{2}}{\sqrt{2 \pi}} \int_{0}^\frac{x}{\sqrt{2}} exp ( - y^2 ) dy \)</p>
<p>\(\Large \displaystyle     = \frac{1}{\sqrt{ \pi}} \int_{0}^\frac{x}{\sqrt{2}} exp ( - y^2 ) dy \)</p>
<p>となりますので，</p>
<p>\(\Large \displaystyle     = \frac{1}{2} ERF \left(\frac{x}{\sqrt{2}} \right)\)</p>
<p>とります，したがって，</p>
<p>\(\Large \displaystyle   NORMSDIST(x) = \frac{1}{2} \left[ 1 + ERF \left(\frac{x}{\sqrt{2}} \right) \right] \)</p>
<p>との関係を導き出すことができます，まだここまでは<span class="Blue-Bold">逆関数</span>が出てきていません．</p>
<p>ここで，</p>
<p>\(\Large \displaystyle     W \equiv NORMSDIST(x) \)</p>
<p>\(\Large \displaystyle     Z \equiv ERF \left(\frac{x}{\sqrt{2}} \right) \)</p>
<p>とおくと，WとZは，</p>
<p>\(\Large \displaystyle     W = \frac{1 +Z}{2} \)</p>
<p>次にそれぞれの逆関数を求めてみましょう．</p>
<p>\(\Large \displaystyle      NORMSDIST^{-1}(W) = x \)</p>
<p>\(\Large \displaystyle      ERF^{-1}(Z) = \frac{x}{\sqrt{2}}  \)</p>
<p>となりますので，</p>
<p>\(\Large \displaystyle      ERF^{-1}(Z) = \frac{1}{\sqrt{2}}  NORMSDIST^{-1}(W) \)</p>
<p>\(\Large \displaystyle       = \frac{1}{\sqrt{2}}  NORMSDIST^{-1}\left\{\frac{1 +x}{2} \right\} \)</p>
<p>となって，</p>
<p>\(\Large \displaystyle       \color{red}{ERFINV(x) = ERF^{-1}(x)= \frac{1}{\sqrt{2}}  NORMSDIST^{-1} \left\{\frac{1 +x}{2} \right\}} \)</p>
<p>を導き出すことができました．</p>
<p>&nbsp;</p>
<p>次ページから二つ目の式に関して解いていきましょう．<a href="Excel-function.html"><br />
</a></p>
<p><span class="style7"><a href="Excel-Gauss-03.html"><img src="L-arrow.png" alt="l" width="57" height="34" /></a> <a href="index.html"><img src="TOP.png" alt="t" width="57" height="34" /></a></span><a href="Excel-Gauss-05.html"><img src="R-arrow.png" alt="r" width="57" height="34" border="0" /></a></p>
</body>
</html>
